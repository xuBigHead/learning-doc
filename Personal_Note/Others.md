# Tprofiler
TProfiler是一个可以在生产环境长期使用的性能分析工具.它同时支持剖析和采样两种方式,记录方法执行的时间和次数,生成方法热点 对象创建热点 线程状态分析等数据,为查找系统性能瓶颈提供数据支持.

TProfiler在JVM启动时把时间采集程序注入到字节码中,整个过程无需修改应用源码.运行时会把数据写到日志文件,一般情况下每小时输出的日志小于50M.

# show-busy-java-threads
查找cpu性能消耗过程
top命令找出消耗CPU高的Java进程及其线程id：
开启线程显示模式（top -H，或是打开top后按H）
按CPU使用率排序（top缺省是按CPU使用降序，已经合要求；打开top后按P可以显式指定按CPU使用降序）
记下Java进程id及其CPU高的线程id
查看消耗CPU高的线程栈：
用进程id作为参数，jstack出有问题的Java进程
手动转换线程id成十六进制（可以用printf %x 1234）
在jstack输出中查找十六进制的线程id（可以用vim的查找功能/0x1234，或是grep 0x1234 -A 20）
查看对应的线程栈，分析问题
查问题时，会要多次上面的操作以分析确定问题，这个过程太繁琐太慢了。